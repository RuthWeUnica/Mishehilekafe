<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Home</title>
    <link rel="manifest" href="manifest.json">
    <link rel="stylesheet" href="styles.css">
    <!-- <script type="module" src="script.js" defer></script> -->

</head>

<body>
    <!-- <div>
        <a href="https://www.medical-rights.co.il">Go to site!</a>
    </div> -->
    <iframe src="https://www.mishehilekafe.co.il/"></iframe>

    <body>
        <script type="module">
            // Import the functions you need from the SDKs you need
            import { initializeApp } from "https://www.gstatic.com/firebasejs/11.0.2/firebase-app.js";
            import { getMessaging, getToken } from "https://www.gstatic.com/firebasejs/11.0.2/firebase-messaging.js";
    
            // בקשת הרשאה להצגת הודעות
            Notification.requestPermission().then(permission => {
                if (permission === 'granted') {
                    console.log('הרשאת Push ניתנה');
                } else {
                    console.log('המשתמש לא נתן הרשאת Push');
                }
            });
    
            // הגדרות Firebase
            const firebaseConfig = {
                apiKey: "AIzaSyDSllBt0vuMT8VboviUDRKF3k1XyheQPcs",
                authDomain: "push-notifications-weunica.firebaseapp.com",
                projectId: "push-notifications-weunica",
                storageBucket: "push-notifications-weunica.appspot.com",
                messagingSenderId: "1042180147223",
                appId: "1:1042180147223:web:3d73406c082f45dcac3452"
            };
    
            // אתחול Firebase
            const app = initializeApp(firebaseConfig);
            const messaging = getMessaging(app);
    
            // רישום ה-Service Worker
            if ('serviceWorker' in navigator) {
                navigator.serviceWorker.register('sw.js', { type: 'module' }).then((registration) => {
                    console.log('Service Worker registered:', registration);
    
                    // קשר את Service Worker עם Firebase Messaging
                    getToken(messaging, {
                        vapidKey: "BKJdFLRgiRiRRNcNlQvRUDv15OIPDtaeXrIfeUClN9whgM1E1WIMt4AZlP8SPeV9vF1R6I3EZGO_OWyHzJTw73g",
                        serviceWorkerRegistration: registration
                    }).then((currentToken) => {
                        if (currentToken) {
                            console.log('Token:', currentToken);
                            // שלחי את הטוקן לשרת שלך (אם נדרש)
                        } else {
                            console.log('No registration token available.');
                        }
                    }).catch((err) => {
                        console.error('An error occurred while retrieving token:', err);
                    });
                }).catch((err) => {
                    console.error('Service Worker registration failed:', err);
                });
            } else {
                console.error('Service Workers are not supported in this browser.');
            }
        </script>
    </body>
    
</body>

</html>
<!-- <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/9.6.1/firebase-app.js";
        import { getMessaging, onMessage } from "https://www.gstatic.com/firebasejs/9.6.1/firebase-messaging.js";

        // Your web app's Firebase configuration
        const firebaseConfig = {
            apiKey: "AIzaSyDNhtfDm2wDFZG1VGiXpMFhy9LaT6W2JmM",
            authDomain: "pwa--project.firebaseapp.com",
            projectId: "pwa--project",
            storageBucket: "pwa--project.appspot.com",
            messagingSenderId: "1019909768765",
            appId: "1:1019909768765:web:6cf28cde31888dd955cc54"
        };
        // Initialize Firebase
        const app = initializeApp(firebaseConfig);
        const messaging = getMessaging(app);

        Notification.requestPermission().then(permission => {
            if (permission === "granted") {
                console.log("Notification permission granted.");
                // Additional logic for getting token or handling messages
            } else {
                console.log("Notification permission denied.");
            }
        });

        // onMessage(messaging, (payload) => {
        //     console.log("Received push notification: ", payload);
        //     // Handle the incoming push notification here
        // });
    </script> -->